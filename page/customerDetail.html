<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="../js/mui.min.js"></script>
    <script src="../js/mui.tpl.min.js"></script>
    <link href="../css/mui.min.css" rel="stylesheet"/>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		<h1 id="J_Title" class="mui-title">顾客详情</h1>
	</header>
	<div class="mui-content">
		<form name="customerForm" class="mui-input-group">
		</form>
	</div>
<script type="text/x-handlebars-template" id="J_Tpl">
<div class="mui-input-row">
	<label>顾客名称：</label>
	<input type="text" name="name" class="mui-input-clear" placeholder="" value="{{#if name}}{{name}}{{/if}}">
</div>
<div class="mui-input-row">
	<label>电话号码：</label>
	<input type="tel" name="mobile" class="mui-input-clear" placeholder="" value="{{#if mobile}}{{mobile}}{{/if}}">
</div>
<div class="mui-input-row">
	<label>顾客编号：</label>
	<input type="text" name="no" class="mui-input-clear" placeholder="您可用于和线下数据做校对，可不填写" value="{{#if no}}{{no}}{{/if}}">
</div>
<div class="mui-input-row">
	<label>性别：</label>
	<label><div class="mui-radio"><input name="sex" type="radio" value="1" {{#if sex}}checked {{/if}}/> 男</div></label>
	<label><div class="mui-radio"><input name="sex" type="radio" value="0" {{#unless sex}}checked {{/if}}/> 女</div></label>
</div>
<div class="mui-input-row">
	<label>出生年月：</label>
	<input type="date" class="mui-input-clear" placeholder="" value="{{#if date}}{{date}}{{/if}}">
</div>
<div class="mui-input-row">
	<label>是否农历：</label>
	<div id="J_Lunar" class="mui-switch{{#if isLunar}} mui-active{{/if}}">
		<div class="mui-switch-handle"></div>
	</div>
</div>
<button class="mui-btn mui-btn-primary mui-btn-block" type="submit">{{#if _id}}修  改{{#else}}增 加{{/if}}</button>
</script>
<script>
mui.init();
(function(form) {
	var detail;
mui.plusReady(function() {
	var self = plus.webview.currentWebview(),
		tpl = Handlebars.compile($('#J_Tpl').html());
		
	if (!detail._id) {
		$('#J_Title').text('新增顾客');
	}
	detail = self.detail || {};
	if (detail.date) {
		detail.date = new Date(detail.date).format('yyyy/MM/dd');
	}
	
	form.innerHTML = tpl(detail);
});
$(form).submit(function() {
	var data = $(this).serializeObject();
	if (data.date) {
		data.date = new Date(data.date).getTime();		
	}
	detail.isLunar = $('#J_Lunar').hasClass('mui-active');
	mui.fire(plus.webview.getWebviewById('page/customerList.html'), 'Customer:update', mui.extend(detail, data));
	plus.webview.currentWebview().close();
});

})(document.forms.customerForm);
</script>
</body>
</html>